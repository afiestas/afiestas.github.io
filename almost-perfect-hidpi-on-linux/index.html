<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Almost perfect HiDPI experience on Linux (Xorg)</title>
  <meta name="description" content="">
  
  <meta name="author" content="Àlex Fiestas's blog">
  <meta name="copyright" content="&copy; Àlex Fiestas's blog 2023">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/monokai_sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <!--<link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">-->
<!-- 	<link rel="manifest" href="/assets/icons/manifest.json"> -->
<!-- 	<meta name="msapplication-TileColor" content="#ffffff"> -->
<!-- 	<meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png"> -->
	<meta name="theme-color" content="#ffffff">

	<!-- Facebook OGP cards -->
  <meta property="og:description" content="" />
  <meta property="og:url" content="http://afiestas.org" />
  <meta property="og:site_name" content="Àlex Fiestas's blog" />
  <meta property="og:title" content="Almost perfect HiDPI experience on Linux (Xorg)" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://afiestas.org/" />
  <meta property="og:image:type" content="" />
  <meta property="og:image:width" content="" />
  <meta property="og:image:height" content="" />

  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Almost perfect HiDPI experience on Linux (Xorg)">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="http://afiestas.org/">
  <meta name="twitter:url" content="http://afiestas.org">

  

	<!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://afiestas.org//almost-perfect-hidpi-on-linux/">
  <link rel="alternate" type="application/rss+xml" title="Àlex Fiestas's blog" href="http://afiestas.org//feed.xml" />
</head>


  <body>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51319654-1', 'auto');
  ga('send', 'pageview');

</script>

    <header class="navigation" role="banner">
  
</header>


    <div class="page-content">
        <div class="post">

<a href="/">
<div class="post-header-container has-cover" style="background-image: url(/assets/header_image2.jpg);">
	<div class="scrim has-cover">
		<header class="post-header">
		  <h1 class="title">Almost perfect HiDPI experience on Linux (Xorg)</h1>
		  <p class="info">by <strong>Àlex Fiestas</strong></p>
		</header>
	</div>
</div>
</a>
<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
	<div class="post-date">March 16, 2017</div>
	<div class="post-categories">
	in 
	  
	  <span>Software libre</span>, 
	  
	
	  
	  <span>Kde</span>, 
	  
	
	  
	  <span>Linux</span>, 
	  
	
	  
	  <span>Desktop</span>
	  
	
	</div>
</section>	

<article class="post-content">
  <p><a href="https://cdn.afiestas.org/posts/2017/02/hidpi_big.png" target="_blank"><img src="https://cdn.afiestas.org/posts/2017/02/hidpi_small.png" alt="Awesome HiDPI on Xorg" /></a></p>

<p>In 2013 I bought a Macbook Pro 13” which came with a HiDPI display (also known as retina display). Already back then the support for
a single HiDPI display was quite alright with KDE4 and a few tweaks here and there. Months later Qt5 got native HiDPI support and most
applications switched from GTK2 to GTK3 and finally the outliers (chromium based apps, godot, arduino…) got support for higher DPIs as well.</p>

<p>This would have meant perfect support for HiDPI on linux already in 2015 or so but we are missing one important thing which is supporting
both HiDPI and normal DPI screens at the same time. In order to support HiDPI screens applications need to render themselves bigger than
they used to, how much bigger depends on the screen pixel density which, for example, in the case of my laptop is from 1.75 to 2 times
bigger.</p>

<p>This means that applications rendered for HiDPI look huge on normal screens:</p>

<h4 id="hidpi-file-dialog-on-regular-screen">HiDPI File dialog on regular screen</h4>
<p><a href="https://cdn.afiestas.org/posts/2017/02/external_noscale_big.png" target="_blank"><img src="https://cdn.afiestas.org/posts/2017/02/external_noscale_small.png" alt="Open dialog looking huge" /></a></p>

<h4 id="scaled-hidpi-file-dialog-on-regular-screen">Scaled HiDPI File dialog on regular screen</h4>
<p><a href="https://cdn.afiestas.org/posts/2017/02/external_scaled_big.png" target="_blank"><img src="https://cdn.afiestas.org/posts/2017/02/external_scaled_small.png" alt="Open dialog looking ok" /></a></p>

<p>Here is where the internet seems to tell you that there is nothing to do but wait until Wayland arrives and saves us all
(I can’t wait for that btw) but that’s actually not true, X can do it.</p>

<p>XRandR allows us to apply transformations on the outputs, like for example rotation, and it also allows us to scale the screens.
Scaling the screens means that X will virtually increase the amount of pixels available in the display and automatically adapt the final
image size to the actual output resolution. For example:</p>

<p>If a 2x2 scale transformation is applied to a 1920x1080 screen it will be seen as a 3840x2160 screen by the applications but X will magically cut that in half before sending
the image to the monitor. So we have effectively turned our normal density screen into HiDPI.</p>

<p>This is an example of how the xrandr command line looks like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xrandr --output eDP1 --auto --output DP1 --auto --scale 2x2 --right-of eDP1
</code></pre></div></div>

<p>This will set DP1 to the default mode, scale it by 2 and place it at the right of the HiDPI laptop screen (eDP1).</p>

<p><em>Wow</em>! <em>Awesome</em>! This is so cool! Why is everybody not doing this? Where is the catch? <br />
Mostly because of one bug: <br />
<a href="https://bugs.freedesktop.org/show_bug.cgi?id=39949">https://bugs.freedesktop.org/show_bug.cgi?id=39949</a></p>

<p>If you read through the bug entry you will find a <a href="https://bugs.freedesktop.org/attachment.cgi?id=94929" target="_blank">patch</a> created by Chris Wilson in 2014
which is shipped by default in some distributions but it has never been integrated into master.</p>

<p>If your distribution doesn’t ship with this patch by default (good for them!) you can build your own xorg-server, the patch should apply until 1.18 and for 1.19
you have a ported version <a href="https://raw.githubusercontent.com/afiestas/xorg-server-patches/master/cursor.patch" target="_blank">here</a>.</p>

<p>Although with this patch the experience is already way better since the applications will look correctly on all screens Qt has a few bugs
that will create weird glitches specially by placing windows where they don’t belong.</p>
<h4 id="drunk-comboboxes">Drunk comboboxes</h4>
<div style="position:relative;padding-bottom:57%"><iframe src="https://gfycat.com/ifr/NegativeReadyBluebird" frameborder="0" scrolling="no" width="100%" height="100%" style="position:absolute;top:0;left:0;" allowfullscreen=""></iframe></div>
<div style="position:relative;padding-bottom:57%"><iframe src="https://gfycat.com/ifr/MilkyTanFallowdeer" frameborder="0" scrolling="no" width="100%" height="100%" style="position:absolute;top:0;left:0;" allowfullscreen=""></iframe></div>
<h4 id="shy-tooltips">Shy tooltips</h4>
<div style="position:relative;padding-bottom:57%"><iframe src="https://gfycat.com/ifr/SlushyUnitedGrison" frameborder="0" scrolling="no" width="100%" height="100%" style="position:absolute;top:0;left:0;" allowfullscreen=""></iframe></div>
<h4 id="jumpy-drag-and-drop">Jumpy Drag And Drop</h4>
<div style="position:relative;padding-bottom:57%"><iframe src="https://gfycat.com/ifr/DemandingFairBettong" frameborder="0" scrolling="no" width="100%" height="100%" style="position:absolute;top:0;left:0;" allowfullscreen=""></iframe></div>

<p><br />
I have been working on 3 patches that solve most of these at least in my day to day use.</p>

<p>These two still need to be reviewed and might not get accepted: <br />
<a href="https://codereview.qt-project.org/#/c/182207/" target="_blank">https://codereview.qt-project.org/#/c/182207/</a> <br />
<a href="https://codereview.qt-project.org/#/c/182392/" target="_blank">https://codereview.qt-project.org/#/c/182392/</a></p>

<p>This one seems to be on track to be merged (Drag and Drop): <br />
<a href="https://codereview.qt-project.org/#/c/182391/" target="_blank">https://codereview.qt-project.org/#/c/182391/</a></p>

<p>With all this patches the HiDPI experience in any modern Linux distro is as good as in macOS and the best part is that we do not have to wait until Wayland.</p>

</article>



<section class="rss">
	<p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
</section>



<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'afiestas';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">Àlex Fiestas's blog</h3>

    <div class="site-navigation">
    	
    	<p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/posts/">Posts</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

    	<p><strong>Contact</strong></p>
      <ul class="social-media-list">
      	<li>
      		<a href="mailto:afiestaso@gmail.com">
	      		<i class="fa fa-envelope-o"></i>
	      		<span class="username">afiestaso@gmail.com</span>
      		</a>
      	</li>

      	

      </ul>
    </div>

    <div class="site-signature">
    	<p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">Playground for hacking</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>
<script>

$(document).ready(function() {

	// Syntax highlighting
	hljs.initHighlightingOnLoad();

	// Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });


});

</script>




  </body>

</html>
